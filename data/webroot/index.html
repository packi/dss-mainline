<html>
  <head>
    <title>digitalStrom - Server</title>
	<script src="prototype.js" language="JavaScript" type="text/javascript"></script>
	<script type="text/javascript" language="JavaScript">
	
	function turnOn(devid) {
	  new Ajax.Request('/json/turnon', 
	    {
	      method:'get', 
	      parameters: {device: devid} 
	    } 
	  );
	}
	
	new Ajax.Request('/json/getdevices', { method:'get',
  onComplete: function(transport, json) {
	  $('numDevs').innerHTML = transport.responseJSON.devices.length;
	  var devs = transport.responseJSON.devices;
	  var devslist = "<ul>";
	  for(i = 0; i < devs.length; i++) {
	    devslist += "<li>" + devs[i].name;
	    devslist += '<a href="#" onclick="turnOn(' + devs[i].id + ')">Turn On</a>';
	    devslist += "</li>";
	    
	  }
	  devslist += "</ul>";
	  $('devList').innerHTML = devslist;
    }
  });
</script>
  </head>
  <body>
    <h1>Welcome to the dSS!</h1>
	<ul>
	  <li><a href="config">Config</a></li>
	</ul>
	<form>
	Connected devices: <span id="numDevs">(...loading...)</span>
	<div id="devList">
	</div>
	</form>
  </body>	
</html>